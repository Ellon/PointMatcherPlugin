<ServerManagerConfiguration>
  <ProxyGroup name="filters">
    <SourceProxy name="PMIcpFilter" class="vtkPMIcpFilter" label="PM Icp Filter">
      <Documentation
         short_help="Performs ICP."
         long_help="Performs ICP.">
      </Documentation>

      <InputProperty
         name="Reference"
         port_index="0"
         command="SetInputConnection">
        <ProxyGroupDomain name="groups">
          <Group name="sources"/>
          <Group name="filters"/>
        </ProxyGroupDomain>
        <DataTypeDomain name="input_type">
          <DataType value="vtkPolyData"/>
        </DataTypeDomain>
        <Documentation>
          Set the input poly data
        </Documentation>
      </InputProperty>

      <InputProperty
         name="Reading"
         port_index="1"
         command="SetInputConnection">
        <ProxyGroupDomain name="groups">
          <Group name="sources"/>
          <Group name="filters"/>
        </ProxyGroupDomain>
        <DataTypeDomain name="input_type">
          <DataType value="vtkPolyData"/>
        </DataTypeDomain>
        <Documentation>
          Set the input poly data
        </Documentation>
      </InputProperty>


      <IntVectorProperty
        name="Matcher"
        number_of_elements="1"
        command="SetMatcher"
        default_values="0">
        <EnumerationDomain name="enum">
          <Entry value="0" text="KDTreeMatcher"/>
          <Entry value="1" text="KDTreeVarDistMatcher"/>
          <Entry value="2" text="NullMatcher"/>
        </EnumerationDomain>
        <Documentation>
          Specify the matcher used.
        </Documentation>
      </IntVectorProperty>

      <IntVectorProperty 
        name="Knn"
        command="SetKnn"
        number_of_elements="1"
        default_values="1">
        <IntRangeDomain name="range" min="1"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="Matcher" values="KDTreeMatcher KDTreeVarDistMatcher"/>
        </Hints>
      </IntVectorProperty>

      <DoubleVectorProperty 
        name="Epsilon"
        command="SetEpsilon"
        number_of_elements="1"
        default_values="0.0">
        <DoubleRangeDomain name="range" min="0.0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="Matcher" values="KDTreeMatcher KDTreeVarDistMatcher"/> 
        </Hints>
      </DoubleVectorProperty>

      <IntVectorProperty
        name="SearchType"
        command="SetSearchType"
        number_of_elements="1"
        default_values="1">
        <EnumerationDomain name="enum">
          <Entry value="0" text="Brute Force"/>
          <Entry value="1" text="KD-Tree With Linear Heap"/>
          <Entry value="2" text="KD-Tree With Tree Heap"/>
        </EnumerationDomain>
        <Documentation>
          Specify the matcher used.
        </Documentation>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="Matcher" values="KDTreeMatcher KDTreeVarDistMatcher"/>
        </Hints>
      </IntVectorProperty>

      <DoubleVectorProperty 
        name="MaxDist"
        command="SetMaxDist"
        number_of_elements="1"
        default_values="99999.99999">
        <DoubleRangeDomain name="range" min="0.0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="Matcher" value="KDTreeMatcher"/>
        </Hints>
      </DoubleVectorProperty>

      <StringVectorProperty 
        name="MaxDistField"
        label="Max Dist Field"
        command="SetMaxDistField"
        number_of_elements="5"
        element_types="0 0 0 0 2"
        animateable="0">
        <ArrayListDomain 
          name="array_list"
          attribute_type="Scalars"
          input_domain_name="inputs_array">
          <RequiredProperties>
            <Property name="Reference" function="Input" />
          </RequiredProperties>
        </ArrayListDomain>
        <FieldDataDomain name="field_list">
          <RequiredProperties>
            <Property name="Reference" function="Input" />
          </RequiredProperties>
        </FieldDataDomain>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="Matcher" value="KDTreeVarDistMatcher"/>
        </Hints>
      </StringVectorProperty>

      <StringVectorProperty name="OutlierFilters"
                            command="AddOutlierFilter"
                            clean_command="CleanOutlierFilters"
                            number_of_elements="0"
                            number_of_elements_per_command="14"
                            element_types="2 2 2 1 0 0 1 1 1 1 1 1 1 1"
                            repeat_command="1">
        <Documentation>
          Define which outlier filters to use and in which order.
        </Documentation>
      </StringVectorProperty>

      <IntVectorProperty
        name="ErrorMinimizer"
        command="SetErrorMinimizer"
        number_of_elements="1"
        default_values="0">
        <EnumerationDomain name="enum">
          <Entry value="0" text="IdentityErrorMinimizer"/>
          <Entry value="1" text="PointToPlaneErrorMinimizer"/>
          <Entry value="2" text="PointToPlaneWithCovErrorMinimizer"/>
          <Entry value="3" text="PointToPointErrorMinimizer"/>
          <Entry value="4" text="PointToPointSimilarityErrorMinimizer"/>
          <Entry value="5" text="PointToPointWithCovErrorMinimizer"/>
        </EnumerationDomain>
        <Documentation>
          Specify the error minimizer used.
        </Documentation>
      </IntVectorProperty>

      <DoubleVectorProperty 
        name="SensorStdDev"
        command="SetSensorStdDev"
        number_of_elements="1"
        default_values="0.01">
        <DoubleRangeDomain name="range" min="0.0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="ErrorMinimizer" values="PointToPlaneWithCovErrorMinimizer PointToPointWithCovErrorMinimizer"/>
        </Hints>
      </DoubleVectorProperty>

      <IntVectorProperty
        name="Force2D"
        command="SetForce2D"
        label="Force 2D"
        number_of_elements="1"
        default_values="0">
        <BooleanDomain name="bool"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_string_attribute_is" property="ErrorMinimizer" values="PointToPlaneErrorMinimizer PointToPlaneWithCovErrorMinimizer"/>
        </Hints>
      </IntVectorProperty>

<!--       <StringVectorProperty label="Transformation Checkers" 
                            element_types="2 0" 
                            name="TransformationCheckerList" 
                            number_of_elements="0" 
                            number_of_elements_per_command="2" 
                            repeat_command="1"> 
        <ArrayListDomain name="array_list"
                         attribute_type="Scalars">
          <Entry value="0" text="BoundTransformationChecker"/>
          <Entry value="1" text="CounterTransformationChecker"/>
          <Entry value="2" text="DifferentialTransformationChecker"/>
        </ArrayListDomain>
      </StringVectorProperty>
 -->

      <IntVectorProperty
        name="UseBoundTransformationChecker"
        command="SetUseBoundTransformationChecker"
        number_of_elements="1"
        default_values="0">
        <BooleanDomain name="bool"/>
      </IntVectorProperty>

      <DoubleVectorProperty 
        name="MaxRotationNorm"
        command="SetMaxRotationNorm"
        number_of_elements="1"
        default_values="1.0">
        <DoubleRangeDomain name="range" min="0.0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseBoundTransformationChecker" value="true"/>
        </Hints>
      </DoubleVectorProperty>

      <DoubleVectorProperty 
        name="MaxTranslationNorm"
        command="SetMaxTranslationNorm"
        number_of_elements="1"
        default_values="1.0">
        <DoubleRangeDomain name="range" min="0.0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseBoundTransformationChecker" value="true"/>
        </Hints>
      </DoubleVectorProperty>

      <IntVectorProperty
        name="UseCounterTransformationChecker"
        command="SetUseCounterTransformationChecker"
        number_of_elements="1"
        default_values="0">
        <BooleanDomain name="bool"/>
      </IntVectorProperty>

      <IntVectorProperty 
        name="MaxIterationCount"
        command="SetMaxIterationCount"
        number_of_elements="1"
        default_values="40">
        <IntRangeDomain name="range" min="0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseCounterTransformationChecker" value="true"/>
        </Hints>
      </IntVectorProperty>

      <IntVectorProperty
        name="UseDifferentialTransformationChecker"
        command="SetUseDifferentialTransformationChecker"
        number_of_elements="1"
        default_values="0">
        <BooleanDomain name="bool"/>
      </IntVectorProperty>

      <DoubleVectorProperty 
        name="MinDiffRotationError"
        command="SetMinDiffRotationError"
        number_of_elements="1"
        default_values="0.001">
        <DoubleRangeDomain name="range" min="0.0" max="6.2831854"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseDifferentialTransformationChecker" value="true"/>
        </Hints>
      </DoubleVectorProperty>
      
      <DoubleVectorProperty 
        name="MinDiffTranslationError"
        command="SetMinDiffTranslationError"
        number_of_elements="1"
        default_values="0.001">
        <DoubleRangeDomain name="range" min="0.0" />
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseDifferentialTransformationChecker" value="true"/>
        </Hints>
      </DoubleVectorProperty>

      <IntVectorProperty 
        name="SmoothLength"
        command="SetSmoothLength"
        number_of_elements="1"
        default_values="3">
        <IntRangeDomain name="range" min="0"/>
        <Hints>
          <PropertyWidgetDecorator type="show_if_boolean_is" name="UseDifferentialTransformationChecker" value="true"/>
        </Hints>
      </IntVectorProperty>

      <PropertyGroup label="Matcher">
        <Property name="Matcher" />
        <Property name="Knn" />
        <Property name="Epsilon" />
        <Property name="SearchType" />
        <Property name="MaxDist" />
        <Property name="MaxDistField" />
      </PropertyGroup>

      <PropertyGroup label="Outlier Filters"
                     panel_widget="outlier_filter_list">
        <Property name="OutlierFilters" />
       </PropertyGroup>

      <PropertyGroup label="Error Minimizer">
        <Property name="ErrorMinimizer" />
        <Property name="SensorStdDev" />
        <Property name="Force2D" />
      </PropertyGroup>

      <PropertyGroup label="Transformation Checkers">
        <!-- <Property name="TransformationCheckerList" /> -->
        <Property name="UseBoundTransformationChecker"/>
        <Property name="MaxRotationNorm" />
        <Property name="MaxTranslationNorm" />
        <Property name="UseCounterTransformationChecker"/>
        <Property name="MaxIterationCount" />
        <Property name="UseDifferentialTransformationChecker"/>
        <Property name="MinDiffRotationError" />
        <Property name="MinDiffTranslationError" />
        <Property name="SmoothLength" />
      </PropertyGroup>

      <Hints> 
        <ShowInMenu category="Point Matcher" />
      </Hints>

    </SourceProxy>
  </ProxyGroup>
</ServerManagerConfiguration>

